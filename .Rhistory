cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:2){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
library(SHT)
## test when k=5 (samples)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:2){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:2){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:2){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
dlist = mylist
##############################################################
# PARAMETERS AND PREPARATION
g = length(dlist) # number of groups
m  = ncol(dlist[[1]])
ni = unlist(lapply(dlist, nrow))-1
n  = sum(ni)
Si = list()
for (i in 1:g){
tgtdata = dlist[[i]]
Si[[i]] = aux_scatter(dlist[[i]])/ni[i]
}
m  = ncol(dlist[[1]])
ni = unlist(lapply(dlist, nrow))-1
n  = sum(ni)
Si = list()
for (i in 1:g){
Si[[i]] = aux_scatter(dlist[[i]])/ni[i]
}
aux_trace <- function(A){
return(sum(diag(A)))
}
aux_scatter <- function(X){
nX = as.matrix(scale(X, center=TRUE, scale=FALSE))
return(t(nX)%*%nX)
}
S  = array(0,c(m,m))
for (i in 1:g){
S = Si[[i]]*ni[i]/n
}
m  = ncol(dlist[[1]])
ni = unlist(lapply(dlist, nrow))-1
n  = sum(ni)
Si = list()
for (i in 1:g){
Si[[i]] = aux_scatter(dlist[[i]])/ni[i]
}
S  = array(0,c(m,m))
for (i in 1:g){
S = Si[[i]]*ni[i]/n
}
etai = (ni+2)*(ni-1)
ni
m  = ncol(dlist[[1]])
m
unlist(lapply(dlist, ncol))
m  = ncol(dlist[[1]])
ni = unlist(lapply(dlist, nrow))-1
n  = sum(ni)
Si = list()
for (i in 1:g){
Si[[i]] = aux_scatter(dlist[[i]])/ni[i]
}
S  = array(0,c(m,m))
for (i in 1:g){
S = Si[[i]]*ni[i]/n
}
etai = (ni+2)*(ni-1)
##############################################################
# MAIN
#   1. test stat
mat.tnm = array(0,c(g,g))
for (i in 1:g){
Sii = Si[[i]]
for (j in 1:g){
Sjj = Si[[j]]
if (i<j){
t1 = (1-(ni[i]-2)/etai[i])*aux_trace(Sii%*%Sii)
t2 = (1-(ni[j]-2)/etai[j])*aux_trace(Sjj%*%Sjj)
t3 = 2*aux_trace(Sii%*%Sjj)
t4 = (ni[i]/etai[i])*((aux_trace(Sii))^2)
t5 = (ni[j]/etai[j])*((aux_trace(Sjj))^2)
mat.tnm[i,j] = (t1+t2-(t3+t4+t5))
}
}
}
mat.tnm
tnm = sum(mat.tnm)
#   2. variance part
aa = ((n^2)/((n+2)*(n-1)))*(aux_trace(S%*%S)-((aux_trace(S)^2)/n))
mat.nij = array(0,c(g,g))
for (i in 1:g){
nii = ni[i]
for (j in 1:g){
njj = ni[j]
if (i<j){
mat.nij[i,j] = (((nii+njj)/(nii*njj))^2)
}
}
}
theta.sq = 4*(aa^2)*(sum(mat.nij)+(g-1)*(g-2)*sum(1/(ni^2)))
theta.sq
sqrt(theta.sq)
theta.sq = 4*(aa^2)*(sum(mat.nij)+(g-1)*(g-2)*sum(1/(ni^2)))
##############################################################
# FINALE
hname   = "Test for Homogeneity of High-Dimensional Covariances by Schott (2007)"
Ha      = "at least one of equalities does not hold."
thestat = tnm/sqrt(theta.sq)
pvalue  = pnorm(thestat, lower.tail = FALSE) # right-hand side
thestat
pvalue
rm(list=ls())
## test when k=5 (samples)
## empirical Type 1 error
k = 5
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
library(SHT)
## test when k=5 (samples)
## empirical Type 1 error
k = 5
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 5
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 10
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 10
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 10
niter   = 10000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 3
niter   = 10000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 3
niter   = 10000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(50*5), ncol=5)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
countkk = rep(0,niter)
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
myda = list()
myda[[1]] = X
myda[[2]] = Y
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
countkk[i] = ifelse(covk.2007Schott(myda)$p.value < 0.05, 1, 0)
}
sum(counter)
sum(countkk)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
countkk = rep(0,niter)
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
myda = list()
myda[[1]] = X
myda[[2]] = Y
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
countkk[i] = ifelse(covk.2007Schott(myda)$p.value < 0.05, 1, 0)
}
sum(counter)
sum(countkk)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
countkk = rep(0,niter)
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
myda = list()
myda[[1]] = X
myda[[2]] = Y
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
countkk[i] = ifelse(covk.2007Schott(myda)$p.value < 0.05, 1, 0)
}
sum(counter)
sum(countkk)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
countkk = rep(0,niter)
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
myda = list()
myda[[1]] = X
myda[[2]] = Y
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
countkk[i] = ifelse(covk.2007Schott(myda)$p.value < 0.05, 1, 0)
}
sum(counter)
sum(countkk)
## test when k=5 (samples)
## empirical Type 1 error
k = 3
n = 4
m = 4
niter   = 10000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(n*m), ncol=m)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
library(SHT)
## empirical Type 1 error
k = 3
n = 4
m = 4
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(n*m), ncol=m)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## empirical Type 1 error
k = 3
n = 4
m = 4
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(n*m), ncol=m)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
library(SHT)
## test when k=5 (samples)
## empirical Type 1 error
k = 3
n = 4
m = 4
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(n*m), ncol=m)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## test when k=5 (samples)
## empirical Type 1 error
k = 3
n = 4
m = 4
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
mylist = list()
for (j in 1:k){
mylist[[j]] = matrix(rnorm(n*m), ncol=m)
}
counter[i] = ifelse(covk.2007Schott(mylist)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'covk.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
library(SHT)
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'cov2.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'cov2.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
## empirical Type 1 error
niter   = 1000
counter = rep(0,niter)  # record p-values
for (i in 1:niter){
X = matrix(rnorm(50*5), ncol=10)
Y = matrix(rnorm(50*5), ncol=10)
counter[i] = ifelse(cov2.2007Schott(X, Y)$p.value < 0.05, 1, 0)
}
## print the result
cat(paste("\n* Example for 'cov2.2007Schott'\n\n",
sprintf("* number of rejections   : %d\n",sum(counter)),
sprintf("* total number of trials : %d\n",niter),
sprintf("* empirical Type 1 error : %.4f\n", sum(counter/niter)),sep=""))
help(var)
library(SHT)
library(SHT)
library(SHT)
library(SHT)
library(SHT)
library(SHT)
library(SHT)
